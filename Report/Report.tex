\documentclass[bachelor, och, referat]{SCWorks}
% параметр - тип обучения - одно из значений:
%    spec     - специальность
%    bachelor - бакалавриат (по умолчанию)
%    master   - магистратура
% параметр - форма обучения - одно из значений:
%    och   - очное (по умолчанию)
%    zaoch - заочное
% параметр - тип работы - одно из значений:
%    referat    - реферат
%    coursework - курсовая работа (по умолчанию)
%    diploma    - дипломная работа
%    pract      - отчет по практике
%    pract      - отчет о научно-исследовательской работе
%    autoref    - автореферат выпускной работы
%    assignment - задание на выпускную квалификационную работу
%    review     - отзыв руководителя
%    critique   - рецензия на выпускную работу
% параметр - включение шрифта
%    times    - включение шрифта Times New Roman (если установлен)
%               по умолчанию выключен
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage{graphicx}

\usepackage[sort,compress]{cite}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyvrb}
\usepackage{longtable}
\usepackage{minted}
\usepackage{array}
\usepackage[english,russian]{babel}
\usepackage{tempora}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{pgfplots}

\usepackage[hidelinks]{hyperref}

\setminted{
	style=bw,
	framesep=2mm, 
	baselinestretch=1.2, 
	fontsize=\small, 
	linenos,
	breaklines=true
}

\newcommand{\eqdef}{\stackrel {\rm def}{=}}

\newtheorem{lem}{Лемма}

\begin{document}

% Кафедра (в родительном падеже)
\chair{математической кибернетики и компьютерных наук}

% Тема работы
\title{Моделирование систем. Вариант 2}

% Курс
\course{4}

% Группа
\group{411}

% Факультет (в родительном падеже) (по умолчанию "факультета КНиИТ")
%\department{факультета КНиИТ}

% Специальность/направление код - наименование
\napravlenie{02.03.02 "--- Фундаментальная информатика и информационные технологии}
%\napravlenie{02.03.01 "--- Математическое обеспечение и администрирование информационных систем}
%\napravlenie{09.03.01 "--- Информатика и вычислительная техника}
%\napravlenie{09.03.04 "--- Программная инженерия}
%\napravlenie{10.05.01 "--- Компьютерная безопасность}

% Для студентки. Для работы студента следующая команда не нужна.
%\studenttitle{cтудента}

% Фамилия, имя, отчество в родительном падеже
\author{Аношкина Андрея Алексеевича}

% Заведующий кафедрой
\chtitle{к.\,ф.-м.\,н., доцент} % степень, звание
\chname{С.\,В.\,Миронов}

%Научный руководитель (для реферата преподаватель проверяющий работу)
\satitle{к.\,ф.-м.\,н., доцент} %должность, степень, звание
\saname{И.\,Е.\,Тананко}

% Руководитель практики от организации (только для практики,
% для остальных типов работ не используется)
\patitle{к.\,ф.-м.\,н., доцент}
\paname{Д.\,Ю.\,Петров}

% Семестр (только для практики, для остальных
% типов работ не используется)
\term{8}

% Наименование практики (только для практики, для остальных
% типов работ не используется)
\practtype{учебная}

% Продолжительность практики (количество недель) (только для практики,
% для остальных типов работ не используется)
\duration{2}

% Даты начала и окончания практики (только для практики, для остальных
% типов работ не используется)
\practStart{01.07.2016}
\practFinish{14.07.2016}

% Год выполнения отчета
\date{2025}

\maketitle

% Включение нумерации рисунков, формул и таблиц по разделам
% (по умолчанию - нумерация сквозная)
% (допускается оба вида нумерации)
%\secNumbering


\tableofcontents

% Раздел "Обозначения и сокращения". Может отсутствовать в работе
%\abbreviations

% Раздел "Определения". Может отсутствовать в работе
%\definitions

% Раздел "Определения, обозначения и сокращения". Может отсутствовать в работе.
% Если присутствует, то заменяет собой разделы "Обозначения и сокращения" и "Определения"
%\defabbr


% Раздел "Введение"
%\intro

\section{МОДЕЛИРОВАНИЕ НЕПРЕРЫВНЫХ СИСТЕМ}

\subsection{Дифференциальные уравнения первого порядка}

\subsubsection{Постановка задачи}

Температура свежевыпеченного хлеба равна 150$^\circ$. До отправки в магазин хлеб остывает в помещении с постоянной температурой 20$^\circ$. Требуется определить длительность времени охлаждения хлеба до 40$^\circ$.

Результат можно получить с использованием закона теплового излучения

\begin{equation*}
\frac{dx}{dt} = -k(x - a),
\end{equation*}

где $x(t)$ "--- температура хлеба в момент времени $t$, $a$ "--- температура воздуха в помещении, $k > 0$ "--- коэффициент пропорциональности. Полагаем, что $k = 0,02$.

\subsubsection{Код}

\begin{minted}{cpp}
#include <iostream>

using namespace std;

const int a = 20;
const float k = 0.02;
const float dt = 1e-3;
const float T = 40;
const float eps = 1e-3;

float f(const float x) {
	return -k * (x - a);
}

int main() {
	float x = 150;
	float t = 0;
	
	for (; abs(x - T) >= eps; t += dt) 
		x += dt * f(x);
	
	cout << "Time: " << t << "\n";

	system("pause");

	return 0;
}
\end{minted}

\subsubsection{Результат}

\begin{figure}[!ht]
\centering
\includegraphics[width=\linewidth]{pictures/pic-1.png}
\end{figure}

\subsection{Системы дифференциальных уравнений}

\subsubsection{Постановка задачи}

Построить фазовый портрет системы дифференциальных уравнений

\begin{equation*}
\begin{cases}
\frac{dx}{dt} = ax - y \\
\frac{dy}{dt} = x + ay
\end{cases}
\end{equation*}

при $-0,2 < a < 0$. Эксперимент повторить при $a > 0$.

\subsubsection{Код}

\begin{minted}{python}
import matplotlib.pyplot as plt
import numpy as np

a = float(input())

def f(x, y):
    return a * x - y

def g(x, y):
    return x + a * y

x = 1
y = 1
t = 0
T = 100
dt = 1e-2

x_coords = [x]
y_coords = [y]

while t < T:
    xn = x + dt * f(x, y)
    yn = y + dt * g(x, y)
    x_coords.append(xn)
    y_coords.append(yn)
    x = xn
    y = yn
    t += dt

xs = np.array(x_coords, dtype=float)
ys = np.array(y_coords, dtype=float)

plt.plot(xs, ys)
plt.show()
\end{minted}

\subsubsection{Результат}

\begin{figure}[!ht]
\centering
\begin{tabular}{ll}
\includegraphics[width=0.5\linewidth]{pictures/pic-2.png}
&
\includegraphics[width=0.5\linewidth]{pictures/pic-3.png}
\end{tabular}
\caption{Левый "--- $a = -0.1$; Правый "--- $a = 0.5$}
\end{figure}

\section{МЕТОД СТАТИСТИЧЕКИХ ИСПЫТАНИЙ}

\subsection{Равномерно распределенная дискретная случайная величина}

\subsubsection{Постановка задачи}

В мусорный бак может поместиться 10 пакетов с мусором. В день в бак с равной вероятностью может поступить 0, 1, 2 или 3 пакета. Построить модель поступления пакетов в бак. На основании 10000 испытаний оценить математическое ожидание числа дней до полного заполнения бака.

\subsubsection{Код}

\begin{minted}{cpp}
#include <iostream>
#include <vector>
#include <time.h>

using namespace std;

const int n = 1e+5;

int main() {
	vector<int> experiments(1000, 0);
	srand(time(0));

	for (int i = 0; i < n; ++i) {
		int days_counter = 0;
		int space_left = 10;
		do {
			days_counter++;
			space_left -= rand() % 4;
		} while (space_left > 0);

		experiments[days_counter] += 1;
	}

	float M = 0;
	for (int i = 1; i < experiments.size(); ++i) 
		M += i * 1.0f * experiments[i] / n;
	
	cout << "M = " << M << "\n";

	system("pause");
	return 0;
}
\end{minted}

\subsubsection{Результат}

\begin{figure}[!ht]
\centering
\includegraphics[width=\linewidth]{pictures/pic-4.png}
\end{figure}

\subsection{Равномерно распределенная непрерывная случайная величина}

\subsubsection{Постановка задачи}

Проверить, действительно ли датчик случайных чисел можно использовать для формирования псевдослучайных чисел $x_i$, $i = 1, 2, \dots$, (на интервале $[0, 1)$), имеющих равномерную функцию распределения. Для решения задачи необходимо построить пары чисел $(x_i, x_{i + 1}$), $i = 1, 2, \dots$, и координаты этих точек отобразить на единичном квадрате. Вывод сделать на основании сначала 50, затем 100 точек, расположенных на единичном квадрате.

\subsubsection{Код}

\begin{minted}{python}
import matplotlib.pyplot as plt
import numpy as np
import random

xs = []
ys = []
N = int(input())

for i in range(N):
    xs.append(random.random())
    ys.append(random.random())

plt.scatter(np.array(xs, dtype=float), np.array(ys, dtype=float))
plt.show()
\end{minted}

\subsubsection{Результат}

\begin{figure}[!ht]
\centering
\begin{tabular}{ll}
\includegraphics[width=0.5\linewidth]{pictures/pic-5.png}
&
\includegraphics[width=0.5\linewidth]{pictures/pic-6.png}
\end{tabular}
\caption{Левый "--- 50 точек; Правый "--- 100 точек}
\end{figure}

\subsection{Нормально распределенная случайная величина}

\subsubsection{Постановка задачи}

Вес коробки с печеньями есть нормально распределенная случайная величина с параметрами $\mu = 100$ гр. и $\sigma = 5$ гр. Одна упаковка содержит 10 коробок с печеньями. Построить модель формирования веса одной упаковки. Оценить математическое ожидание и среднее квадратическое отклонение веса одной упаковки на основании 1000 испытаний.

\subsubsection{Код}

\begin{minted}{cpp}
#include <iostream>
#include <vector>
#include <time.h>

using namespace std;

const int n = 1000;
const int Mu = 100;
const int sigma = 5;

float generate() {
	float R = 0;
	for (int i = 0; i < 12; ++i) 
		R += rand() * 1.f / RAND_MAX;
	
	return Mu + sigma * (R - 6);
}

int main() {
	srand(time(0));
	vector<float> weights;

	float M = 0;
	for (int i = 0; i < n; ++i) {
		float weight = 0;
		for (int j = 0; j < 10; ++j) 
			weight += generate();
		
		M += weight * 1.0f / n;
		weights.push_back(weight);
	}


	float sqr_sum = 0;
	for (int i = 0; i < n; ++i) 
		sqr_sum += (weights[i] - M) * (weights[i] - M);
	
	float S = sqrt(sqr_sum / (n - 1));

	cout << "M = " << M << "\n";
	cout << "S = " << S << "\n";

	system("pause");
	return 0;
}
\end{minted}

\subsubsection{Результат}

\newpage

\begin{figure}[!ht]
\centering
\includegraphics[width=\linewidth]{pictures/pic-7.png}
\end{figure}

\subsection{Экспоненциально распределенная случайная величина}

\subsubsection{Постановка задачи}

С момента появления первых признаков неисправности до полного отказа элемента проходит экспоненциально распределенный интервал времени. Математическое ожидание этого интервала равно 1. Через равные интервалы времени (равные 0,5) элемент проходит техническое обслуживание и с вероятностью 0,7 признаки неисправности будут обнаружены и элемент будет заменен. На основании 10000 исходов (замена элемента или его отказ) оценить вероятность того, что неисправность элемента не будет обнаружена при проведении технического обслуживания и этот элемент выйдет из строя.

\subsubsection{Код}

\begin{minted}{cpp}
#include <iostream>
#include <time.h>
#include <cmath>

using namespace std;

const float lambda = 1;
const int n = 1e+4;

float generate() {
	return -1.f / lambda * log(rand() * 1.f / RAND_MAX);
}

int main() {
	srand(time(0));
	float chance = 0;
	float T = 0;

	for (int i = 0; i < n; ++i) {
		float t = generate();
		T += t;
		while (t > 0) {
			t -= 0.5;
			if (rand() % 10 < 7)
				break;
			else if (t < 0)
				chance++;
		}
	}

	chance /= n;

	cout << "Chance = " << chance * 100 << "%\n";

	system("pause");
	return 0;
}
\end{minted}

\subsubsection{Результат}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.8\linewidth]{pictures/pic-8.png}
\end{figure}

% Раздел "Заключение"
%\conclusion


%Библиографический список, составленный вручную, без использования BibTeX
%
%\begin{thebibliography}{99}
%  \bibitem{Ione} Источник 1.
%  \bibitem{Itwo} Источник 2
%\end{thebibliography}

%Библиографический список, составленный с помощью BibTeX
%
%\bibliographystyle{gost780uv}
%\bibliography{thesis}

%\appendix


% Окончание основного документа и начало приложений
% Каждая последующая секция документа будет являться приложением
%\appendix

\end{document}
